<?php eval(base64_decode('b3V0cHV0KCdIRUxQOiB0Lm1lL2xvb2tzdG9yaWVzYm90Jyk7CgpyZXF1aXJlIF9fRElSX18uJy92ZW5kb3IvYXV0b2xvYWQucGhwJzsKJGlnID0gbmV3IFxJbnN0YWdyYW1BUElcSW5zdGFncmFtKCk7Cgp0cnkgewoKICAgICRsb2dpbiA9IGdldFZhckZyb21Vc2VyKCJMb2dpbiIpOwogICAgJHBhc3N3b3JkID0gZ2V0VmFyRnJvbVVzZXIoIlBhc3N3b3JkIik7CgogICAgdHJ5IHsKICAgICAgICAkaWctPmxvZ2luKCRsb2dpbiwgJHBhc3N3b3JkKTsKICAgIH0gY2F0Y2ggKFxFeGNlcHRpb24gJGUpIHsKICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCRlLT5nZXRNZXNzYWdlKCkpOwogICAgfQogICAgb3V0cHV0KCJMb2dnZWQgYXMgJGxvZ2luIHN1Y2Nlc3MiKTsKCgogICAgJHJhbmtfdG9rZW4gPSBcSW5zdGFncmFtQVBJXFNpZ25hdHVyZXM6OmdlbmVyYXRlVVVJRCgpOwoKICAgICR1c2VyX2lkID0gJGlnLT5wZW9wbGUtPmdldFVzZXJJZEZvck5hbWUoJGlnLT51c2VybmFtZSk7CiAgICAkc3VicyA9ICRpZy0+cGVvcGxlLT5nZXRGb2xsb3dlcnMoJHVzZXJfaWQsICRyYW5rX3Rva2VuLCBudWxsLCBudWxsKS0+Z2V0VXNlcnMoKTsKICAgIG91dHB1dCgnR290ICcgLiBjb3VudCgkc3VicykgLiAnIHByb2ZpbGVzJyk7CiAgICBpZiAoISR1c2VyX2lkKSB0aHJvdyBuZXcgRXhjZXB0aW9uKCdTb21ldGhpbmcgd3JvbmcsIHRyeSBhZ2FpbicpOwoKCiAgICBmb3JlYWNoICgkc3VicyBhcyAkc3ViKXsKICAgICAgICAkbWF4X2lkID0gbnVsbDsKICAgICAgICBkbyB7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgIGlmKCRzdWItPmdldEZvbGxvd2VyQ291bnQoKSA+IDEwMDApIHRocm93IG5ldyBFeGNlcHRpb24oJ1RvbyBtdWNoIHByb2ZpbGVzIHRvIGxvb2tpbmcsIG5leHQuLicpOwogICAgICAgICAgICAgICAgJGZvbGxvd2VycyA9ICRpZy0+cGVvcGxlLT5nZXRGb2xsb3dlcnMoJHN1Yi0+Z2V0UGsoKSwgJHJhbmtfdG9rZW4sIG51bGwsICRtYXhfaWQpOwogICAgICAgICAgICAgICAgb3V0cHV0KCdHb3QgJyAuIGNvdW50KCRmb2xsb3dlcnMtPmdldFVzZXJzKCkpIC4gIiBAIi4kc3ViLT5nZXRVc2VybmFtZSgpLiIncyBmb2xsb3dlcnMiKTsKICAgICAgICAgICAgICAgIGlmICghJGZvbGxvd2VycykgdGhyb3cgbmV3IEV4Y2VwdGlvbigiQ2FuJ3QgZ2V0IEAiLiRzdWItPmdldFVzZXJuYW1lKCkuIidzIGZvbGxvd2VycywgZ29pbmcgdG8gdGhlIG5leHQgcHJvZmlsZSIpOwoKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRmb2xsb3dlcnMtPmdldFVzZXJzKCkgYXMgJGZvbGxvd2VyKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoJGZvbGxvd2VyLT5nZXRGb2xsb3dpbmdDb3VudCgpIDwgMTAwMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICRmb2xsb3dlcl9pZCA9ICRmb2xsb3dlci0+Z2V0UGsoKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHN0b3JpZXMgPSAkaWctPnN0b3J5LT5nZXRVc2VyUmVlbE1lZGlhRmVlZCgkZm9sbG93ZXJfaWQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZihpc3NldCgkc3RvcmllcykgJiYgJHN0b3JpZXMtPmlzT2soKSAmJiBjb3VudCgkc3Rvcmllcy0+Z2V0SXRlbXMoKSkgPiAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpZy0+c3RvcnktPm1hcmtNZWRpYVNlZW4oJHN0b3JpZXMtPmdldEl0ZW1zKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0KGNvdW50KCRzdG9yaWVzLT5nZXRJdGVtcygpKSAuICIgc3RvcmllcyBieSAjJGZvbGxvd2VyX2lkIG1hcmtlZCBzZWVuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9ZWxzZSBvdXRwdXQoJ1RvbyBtdWNoIGZvbGxvd2VycywgY2FuXCd0IHNhdyBvdXIgYWN0aXZpdHknKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRtYXhfaWQgPSAkZm9sbG93ZXJzLT5nZXROZXh0TWF4SWQoKTsKICAgICAgICAgICAgfWNhdGNoIChFeGNlcHRpb24gJGUpewogICAgICAgICAgICAgICAgb3V0cHV0KCRlLT5nZXRNZXNzYWdlKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNsZWVwKHJhbmQoMSwgMykpOwogICAgICAgIH0gd2hpbGUgKCRtYXhfaWQgIT09IG51bGwpOwogICAgfQp9Y2F0Y2ggKEV4Y2VwdGlvbiAkZSl7CiAgICBvdXRwdXQoJGUtPmdldE1lc3NhZ2UoKSk7Cn0KCmZ1bmN0aW9uIGdldFZhckZyb21Vc2VyKCR0ZXh0KSB7CiAgICBlY2hvICR0ZXh0IC4gIjogIjsKICAgICR2YXIgPSB0cmltKGZnZXRzKFNURElOKSk7CiAgICByZXR1cm4gJHZhcjsKfQoKZnVuY3Rpb24gb3V0cHV0KCRtZXNzYWdlKXsKICAgIGVjaG8gIlsiLCBkYXRlKCJIOmk6cyIpLCAiXSAiLCAkbWVzc2FnZSwgUEhQX0VPTDsKfQ=='));
